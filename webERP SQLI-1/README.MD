
## WebERP SQL injection Vulnerability Description
 - Author: YU-HSIANG HUANG, YUNG-HAO TSENG, Eddie TC CHANG
 - Contact: huang.yuhsiang.phone@gmail.com; 0xuhaw@gmail.com; eddietcchang@gmail.com
---
 ### Testing Target
 - Product: webERP 4.15
 - Last updated: 2018/05/21
 - Official Website: http://www.weberp.org/
 - Github: https://github.com/webERP-team/webERP

 ### Abstract
The `SalesInquiry.php` have SQL Injection vulnerability in `SortBy` parameter, here we can use the sleep function or other functions following the order by.

 ### Concept
 1. First, we download the latest version from the official website and view the source code of /webERP/`SalesInquiry.php`.
![](./png/1.png)

 2. From the `SalesInquiry.php` source we discovered `SortBy` parameter has SQL injection vulnerability in line 222.
![](./png/2.png)

 3. OK, we quickly use webERP Demo Company to try SQL Injection problem.
![](./png/3.png)

 4. Choose `Sales Order Detail Or Summary Inquiries` feature.
![](./png/4.png)

 5. Please adjust the time to an earlier date to make sure you can find the information.
![](./png/5.png)

 6. Here we found a total of 9 data,  please remember this number which a key point is.    
![](./png/6.png)

7. Repeat the above steps to adjust the time and use Burp Suite to Intercept the packet.
![](./png/7.png)
![](./png/8.png)

8. In the `SortBy` parameter we insert sample SQL Injection payload.
* Payloadï¼š`and sleep(1)`
![](./png/9.png)

9. Very incredible things happen, if you set sleep 1 second, it will cause `sec` * `total data number`.
* sleep(1) * 9 = 9 sec
* sleep(2) * 9 = 18 sec
![](./png/10.png)
![](./png/11.png)

