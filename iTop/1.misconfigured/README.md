## iTop Misconfiguration Vulnerability Description
 - Author: YU-HSIANG HUANG, YUNG-HAO TSENG, CHUNG-NAN TSAI
 - Contact: huang.yuhsiang.phone@gmail.com; 0xuhaw@gmail.com; SeanCai12699@gmail.com
 - Company: NextBank; Panasonic; freelancer
---
 ### Testing Target
 - Product：iTop
 - Version：2.7.0-beta2
 - Official Website：https://github.com/Combodo/iTop
 - Affect：All Version <= 2.7.0-beta2
 
 ### Abstract
The `restore_exec` function of the `exec.php` page is missing the `LoginWebPage :: DoLogin ()` condition, which will cause the attacker without login to use this function and disclosure of system information.

 ### Concept
1. We download the latest version from the official github and build default environment.
![](./img/1.jpg)

2. View `ajax.backup.php` source code and we guess these miss some condition to check exec.php
 ![](./img/2.jpg)
 
3. Now we can use `restore_exec` funtion without login and it will expose the system information.
![](./img/3.jpg)
Payload: `http://127.0.0.1/pages/exec.php?exec_module=itop-backup&exec_page=ajax.backup.php&exec_env=production&operation=restore_exec`
![](./img/4.jpg)



