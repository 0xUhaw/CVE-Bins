## iTop Misconfiguration Vulnerability Description
 - Author: YU-HSIANG HUANG, YUNG-HAO TSENG, CHUNG-NAN TSAI
 - Contact: huang.yuhsiang.phone@gmail.com; 0xuhaw@gmail.com; SeanCai12699@gmail.com
---
 ### Testing Target
 - Product：iTop
 - Version：2.7.0-beta2
 - Official Website：https://github.com/Combodo/iTop
 - Affect：All Version <= 2.7.0-beta2
 
 ### Abstract
The `restore_exec` function of the `exec.php` page is missing the `LoginWebPage :: DoLogin ()` condition, which will cause the attacker without login to use this function and disclosure of system information.

 ### Concept
 1. We download the latest version from the official website and build default environment.
![](./png/1.png)

 2. View `connect.php` source code and find the `method` parameter of line 27 is not filtered, it will cause XSS vulnerabilities.
![](./png/2.png)
![](./png/3-1.png)

 3. Now we insert XSS payload after the `method` parameter.
 - `<svg onload=confirm(1)>`
![](./png/4.png)

4. That's a great result.
![](./png/5.png)



